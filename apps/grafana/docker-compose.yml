
services:
  grafana:
    image: grafana/grafana:12.1.4
    container_name: grafana
    user: "472"
    restart: unless-stopped
    environment:
      # Enable auth proxy to accept X-WEBAUTH-USER header from ForwardAuth
      GF_AUTH_PROXY_ENABLED: "true"
      GF_AUTH_PROXY_HEADER_NAME: "X-WEBAUTH-USER"
      GF_AUTH_PROXY_HEADER_PROPERTY: "username"
      GF_AUTH_PROXY_AUTO_SIGN_UP: "true"
    logging:
      driver: journald
      options:
        tag: "{{.Name}}"
    ports:
      - "${GRAFANA_PORT:-3001}:3000"
    volumes:
      - ${CONTAINER_DATA_ROOT}/data:/var/lib/grafana
    networks:
      - grafana-net

networks:
  grafana-net:
    driver: bridge
