services:
  grafana:
    image: grafana/grafana:12.1.4
    container_name: grafana
    user: "472"
    restart: unless-stopped
    environment:
      # Enable auth proxy to accept X-WEBAUTH-USER header from ForwardAuth
      GF_AUTH_PROXY_ENABLED: "true"
      GF_AUTH_PROXY_HEADER_NAME: "X-WEBAUTH-USER"
      GF_AUTH_PROXY_HEADER_PROPERTY: "username"
      GF_AUTH_PROXY_AUTO_SIGN_UP: "true"
    logging:
      driver: journald
      options:
        tag: "{{.Name}}"
    # No direct port exposure - access via Traefik at grafana.{hostname}.local
    # halos-proxy-network is auto-injected by container-packaging-tools
    volumes:
      - ${CONTAINER_DATA_ROOT}/data:/var/lib/grafana
