
services:
  influxdb:
    image: influxdb:2.7.12
    container_name: influxdb
    restart: unless-stopped
    logging:
      driver: journald
      options:
        tag: "{{.Name}}"
    ports:
      - "${INFLUXDB_PORT:-8086}:8086"
    volumes:
      - ${CONTAINER_DATA_ROOT}/config:/etc/influxdb2
      - ${CONTAINER_DATA_ROOT}/db:/var/lib/influxdb2
    environment:
      - DOCKER_INFLUXDB_INIT_MODE=setup
      - DOCKER_INFLUXDB_INIT_USERNAME=${INFLUXDB_ADMIN_USER:-admin}
      - DOCKER_INFLUXDB_INIT_PASSWORD=${INFLUXDB_ADMIN_PASSWORD:-halos}
      - DOCKER_INFLUXDB_INIT_ORG=${INFLUXDB_ORG:-marine}
      - DOCKER_INFLUXDB_INIT_BUCKET=${INFLUXDB_BUCKET:-marine}
      - DOCKER_INFLUXDB_INIT_ADMIN_TOKEN=${INFLUXDB_ADMIN_TOKEN:-halos-default-token-change-in-production}
      - DOCKER_INFLUXD_QUERY_CONCURRENCY=1
      - DOCKER_INFLUXD_QUERY_MEMORY_BYTES=20971520
    networks:
      - influxdb-net

networks:
  influxdb-net:
    driver: bridge
